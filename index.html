<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anatomía Floral | Experiencia Inmersiva Completa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Outfit', sans-serif;
            background: #060b14;
            color: #f8fafc;
            overflow-x: hidden;
        }

        .glass {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }

        .glow-pink { text-shadow: 0 0 20px rgba(236, 72, 153, 0.3); }
        
        @keyframes pulse-soft {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        .animate-pulse-slow { animation: pulse-soft 3s infinite; }

        #fullscreen-btn { transition: all 0.3s ease; }
        #fullscreen-btn:hover { transform: rotate(90deg) scale(1.1); background: #ec4899; }

        .btn-active-all { background-color: #ec4899 !important; color: white !important; box-shadow: 0 0 15px rgba(236, 72, 153, 0.4); }
        .btn-active-gineceo { background-color: #ec4899 !important; color: white !important; box-shadow: 0 0 15px rgba(236, 72, 153, 0.4); }
        .btn-active-androceo { background-color: #3b82f6 !important; color: white !important; box-shadow: 0 0 15px rgba(59, 130, 246, 0.4); }
        .btn-active-perianto { background-color: #10b981 !important; color: white !important; box-shadow: 0 0 15px rgba(16, 185, 129, 0.4); }
        .btn-active-soporte { background-color: #f59e0b !important; color: white !important; box-shadow: 0 0 15px rgba(245, 158, 11, 0.4); }

        .loader {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #ec4899;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: none;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .detail-card {
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Modal de Detalle Educativo Multi-Nivel -->
    <div id="detail-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/95 backdrop-blur-2xl" onclick="closeDetail()"></div>
        <div class="glass relative max-w-4xl w-full p-6 md:p-10 rounded-[2.5rem] border-white/10 detail-card scale-90 opacity-0 overflow-y-auto max-h-[95vh] custom-scroll" id="modal-content">
            <button onclick="closeDetail()" class="absolute top-8 right-8 text-slate-400 hover:text-white transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <div id="modal-body" class="space-y-8"></div>
        </div>
    </div>

    <!-- Botón Pantalla Completa -->
    <button id="fullscreen-btn" onclick="toggleFullScreen()" class="fixed bottom-6 right-6 z-50 bg-slate-800/80 backdrop-blur text-white w-12 h-12 rounded-full shadow-2xl flex items-center justify-center border border-white/10">
        <svg id="fs-icon-enter" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3"/><path d="M21 8V5a2 2 0 0 0-2-2h-3"/><path d="M3 16v3a2 2 0 0 0 2 2h3"/><path d="M16 21h3a2 2 0 0 0 2-2v-3"/></svg>
        <svg id="fs-icon-exit" class="hidden" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3v3a2 2 0 0 1-2 2H3"/><path d="M21 8h-3a2 2 0 0 1-2-2V3"/><path d="M3 16h3a2 2 0 0 1 2 2v3"/><path d="M16 21v-3a2 2 0 0 1 2-2h3"/></svg>
    </button>

    <div class="max-w-7xl mx-auto px-6 py-10">
        <header class="text-center mb-12">
            <div class="inline-block px-3 py-1 rounded-full border border-pink-500/20 text-pink-500 text-[9px] font-black tracking-[0.3em] mb-4 animate-pulse-slow uppercase">
                Anatomía Botánica Profesional
            </div>
            <h1 class="text-5xl md:text-7xl font-extrabold mb-3 tracking-tighter glow-pink">
                FLORAL <span class="text-pink-500 font-light tracking-widest">CORE</span>
            </h1>
            <p class="text-slate-500 text-xs font-bold tracking-[0.2em] uppercase">Explorador Integral de Estructuras (Manual Bimodal)</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
            <div class="lg:col-span-7 space-y-6">
                <div class="glass p-3 rounded-[2rem] shadow-2xl relative overflow-hidden group">
                    <div class="relative rounded-[1.5rem] overflow-hidden bg-black/60 flex items-center justify-center min-h-[450px] border border-white/5">
                        <img id="main-image" src="image_97e42e.png" class="max-h-[400px] w-auto object-contain transition-all duration-700">
                        <div id="image-loader" class="absolute inset-0 flex-col items-center justify-center bg-black/40 backdrop-blur-sm hidden">
                            <div class="loader mb-4" style="display: block;"></div>
                            <p class="text-[10px] font-bold tracking-widest text-pink-400 uppercase">Enfocando morfología...</p>
                        </div>
                    </div>
                </div>

                <div class="flex flex-wrap justify-center gap-2">
                    <button id="btn-all" onclick="filterParts('all')" class="category-btn glass text-slate-400 px-6 py-3 rounded-xl font-black text-[10px] tracking-[0.2em] transition-all uppercase">Todo</button>
                    <button id="btn-gineceo" onclick="filterParts('gineceo')" class="category-btn glass text-slate-400 px-6 py-3 rounded-xl font-black text-[10px] tracking-[0.2em] transition-all uppercase">Gineceo (Pistilo)</button>
                    <button id="btn-androceo" onclick="filterParts('androceo')" class="category-btn glass text-slate-400 px-6 py-3 rounded-xl font-black text-[10px] tracking-[0.2em] transition-all uppercase">Androceo (Estambres)</button>
                    <button id="btn-perianto" onclick="filterParts('perianto')" class="category-btn glass text-slate-400 px-6 py-3 rounded-xl font-black text-[10px] tracking-[0.2em] transition-all uppercase">Perianto</button>
                    <button id="btn-soporte" onclick="filterParts('soporte')" class="category-btn glass text-slate-400 px-6 py-3 rounded-xl font-black text-[10px] tracking-[0.2em] transition-all uppercase">Soporte</button>
                </div>
            </div>

            <div class="lg:col-span-5 h-[650px] overflow-y-auto pr-2 custom-scroll" id="info-panel"></div>
        </div>
    </div>

    <script>
        const apiKey = "";
        const anatomyData = {
            gineceo: {
                title: "Gineceo (Pistilo)",
                scientificTitle: "Verticilo Femenino",
                color: "text-pink-500",
                bg: "border-pink-500/20",
                btnClass: "btn-active-gineceo",
                prompt: "Botanical scientific illustration of flower's ovary and internal ovules, glowing pink lines, high detail, dark mode",
                parts: [
                    { 
                        name: "Estigma", 
                        desc: "Punta receptiva del pistilo.", 
                        edu: "Es la 'puerta de entrada' pegajosa. Su trabajo es capturar el polen que flota en el aire o que traen las abejas.",
                        technical: "Parte terminal del carpelo. Posee un tejido glandular que secreta fluidos viscosos para facilitar la adherencia y germinación del polen.",
                        visual: "Se encuentra en la punta superior del conducto central.",
                        vocabulary: [{ term: "Apical", def: "Situado en el extremo o punta." }, { term: "Germinación", def: "Comienzo del crecimiento de una semilla o grano de polen." }]
                    },
                    { 
                        name: "Estilo", 
                        desc: "Conducto de comunicación del pistilo.", 
                        edu: "Es el 'tubo' o ascensor que comunica la punta de la flor con el interior del pistilo.",
                        technical: "Prolongación cilíndrica del ovario. Actúa como tejido de transmisión para que el tubo polínico alcance los óvulos.",
                        visual: "Es la columna que sostiene al estigma.",
                        vocabulary: [{ term: "Cilíndrico", def: "Con forma de tubo o cilindro." }, { term: "Transmisión", def: "Acción de pasar algo de un lugar a otro." }]
                    },
                    { 
                        name: "Ovario", 
                        desc: "Base reproductora del gineceo.", 
                        edu: "Es la 'habitación' de seguridad del pistilo donde se protegen los óvulos antes de convertirse en semillas.",
                        technical: "Cavidad basal ensanchada formada por carpelos fusionados. Contiene la placenta donde se insertan los primordios seminales.",
                        visual: "La parte redondeada y ancha en la base del gineceo.",
                        vocabulary: [{ term: "Carpelo", def: "Hojas modificadas que forman el gineceo o pistilo." }, { term: "Placenta", def: "Tejido interno donde se anclan los óvulos." }]
                    },
                    { 
                        name: "Óvulo", 
                        desc: "Gametofito femenino (semilla en formación).", 
                        edu: "Son bolitas diminutas. Cuando se encuentran con el polen, 'despiertan' y se transforman en las semillas de la planta.",
                        technical: "Primordio seminal que contiene el saco embrionario. Tras la fecundación, madura para transformarse en semilla.",
                        visual: "Puntos pequeños dentro de la parte redonda (ovario).",
                        vocabulary: [{ term: "Fecundación", def: "Unión de la célula masculina y femenina." }, { term: "Primordio", def: "Estado inicial de un órgano." }]
                    }
                ]
            },
            androceo: {
                title: "Androceo (Estambres)",
                scientificTitle: "Verticilo Masculino",
                color: "text-blue-500",
                bg: "border-blue-500/20",
                btnClass: "btn-active-androceo",
                prompt: "Micro photography of flower anthers and glowing yellow pollen grains, blue highlights, extreme macro, dark background",
                parts: [
                    { 
                        name: "Antera", 
                        desc: "Órgano productor de polen.", 
                        edu: "Es la 'fábrica' del estambre. Son como bolsitas que cuando están listas se abren para soltar el polvo amarillo.",
                        technical: "Parte fértil del estambre dividida en tecas. Contiene los sacos polínicos donde ocurre la microsporogénesis.",
                        visual: "Bolsas amarillas en los extremos de los estambres.",
                        vocabulary: [{ term: "Teca", def: "Cada una de las dos mitades de la antera." }, { term: "Fértil", def: "Capaz de producir vida." }]
                    },
                    { 
                        name: "Conectivo", 
                        desc: "Tejido de unión de la antera.", 
                        edu: "Es el 'pegamento' o pieza de unión. Sirve para sujetar las dos mitades de la fábrica (antera) al filamento.",
                        technical: "Tejido estéril que conecta las dos tecas de la antera. Continuación del filamento a través del receptáculo polínico.",
                        visual: "Pequeña zona central que une las dos tecas amarillas.",
                        vocabulary: [{ term: "Estéril", def: "Parte que no produce polen ni semillas." }, { term: "Vascular", def: "Que tiene conductos para líquidos." }]
                    },
                    { 
                        name: "Grano de Polen", 
                        desc: "Portador de la genética masculina.", 
                        edu: "Es el 'polvo mágico'. Cada granito es una cápsula ultra-resistente que viaja para encontrar otra flor.",
                        technical: "Gametofito masculino con pared protectora (exina). Contiene los núcleos generativos.",
                        visual: "Polvo fino que sale de las anteras.",
                        vocabulary: [{ term: "Exina", def: "Capa externa durísima del polen." }, { term: "Gametofito", def: "Fase de la planta que produce gametos." }]
                    },
                    { 
                        name: "Filamento", 
                        desc: "Soporte del estambre.", 
                        edu: "Es el 'palito' largo. Su misión es levantar la antera para que el viento o los insectos se la lleven puesta.",
                        technical: "Eje estéril que sostiene la antera. Determina la posición estratégica respecto al estigma.",
                        visual: "Hilo delgado que nace de la base y sostiene la antera.",
                        vocabulary: [{ term: "Eje", def: "Línea o soporte central de una estructura." }, { term: "Estratégica", def: "Posición ideal para un objetivo." }]
                    }
                ]
            },
            perianto: {
                title: "Perianto",
                scientificTitle: "Estructuras de Protección (Envoltura)",
                color: "text-emerald-500",
                bg: "border-emerald-500/20",
                btnClass: "btn-active-perianto",
                prompt: "Hyper-realistic scientific botanical illustration of vibrant flower petals and green sepals, emerald and neon green glowing edges, dark background, 8k resolution",
                parts: [
                    { 
                        name: "Pétalo", 
                        desc: "Hojas coloreadas (Corola).", 
                        edu: "Son los 'carteles de neón'. Sus colores brillantes atraen a los polinizadores para que vengan a comer.",
                        technical: "Antófilo modificado con pigmentos (cromoplastos). El conjunto forma la Corola.",
                        visual: "Hojas grandes y coloridas de la flor.",
                        vocabulary: [{ term: "Corola", def: "Conjunto de todos los pétalos." }, { term: "Cromoplasto", def: "Orgánulo celular con color." }]
                    },
                    { 
                        name: "Sépalo", 
                        desc: "Hojas protectoras externas (Cáliz).", 
                        edu: "Es el 'escudo'. Cuando la flor es un capullo cerrado, los sépalos la envuelven para protegerla.",
                        technical: "Piezas que forman el Cáliz. Protegen los verticilos internos durante la etapa de botón floral.",
                        visual: "Pequeñas hojas verdes justo debajo de los pétalos.",
                        vocabulary: [{ term: "Cáliz", def: "Conjunto de todos los sépalos." }, { term: "Preantesis", def: "Etapa previa a la apertura floral." }]
                    }
                ]
            },
            soporte: {
                title: "Soporte y Nutrición",
                scientificTitle: "Base Estructural y Receptáculo",
                color: "text-amber-500",
                bg: "border-amber-500/20",
                btnClass: "btn-active-soporte",
                prompt: "Detailed botanical diagram of a flower base, showing the receptacle, nectaries and pedicel, glowing amber and golden highlights, scientific macro style, dark atmospheric background",
                parts: [
                    { 
                        name: "Nectario", 
                        desc: "Glándula de recompensa.", 
                        edu: "Es el 'dispensador de comida'. Produce néctar (agua dulce) para premiar a los insectos.",
                        technical: "Tejido secretor de fluidos ricos en glúcidos (néctar). Fomenta la polinización biótica.",
                        visual: "Ubicado en la base interna de los verticilos.",
                        vocabulary: [{ term: "Secretor", def: "Que expulsa una sustancia." }, { term: "Glúcidos", def: "Azúcares energéticos." }]
                    },
                    { 
                        name: "Eje Floral", 
                        desc: "Plataforma de anclaje (Receptáculo).", 
                        edu: "Es el 'suelo' sólido. Aquí es donde se enganchan todas las piezas de la flor para no caerse.",
                        technical: "Extremo dilatado del pedículo (receptáculo) donde se insertan los verticilos florales.",
                        visual: "Zona ancha donde termina el tallo y empieza la flor.",
                        vocabulary: [{ term: "Verticilo", def: "Capas o niveles de la flor." }, { term: "Receptáculo", def: "Plataforma de la flor." }]
                    },
                    { 
                        name: "Pedículo", 
                        desc: "Conexión con el tallo principal.", 
                        edu: "Es el 'puente' o ramita. Por aquí viaja el agua y la comida desde las raíces hasta la flor.",
                        technical: "Eje que sostiene la flor solitaria. Conecta el receptáculo con el sistema caulinar.",
                        visual: "Tallo individual que sostiene a la flor.",
                        vocabulary: [{ term: "Sistema Caulinar", def: "Tallos y hojas de la planta." }, { term: "Savia", def: "Líquido alimenticio de la planta." }]
                    }
                ]
            }
        };

        const imageCache = { 'all': 'image_97e42e.png' };

        async function generateView(category) {
            const loader = document.getElementById('image-loader');
            const img = document.getElementById('main-image');
            if (imageCache[category]) { img.src = imageCache[category]; return; }
            loader.style.display = 'flex';
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ instances: [{ prompt: anatomyData[category].prompt }], parameters: { sampleCount: 1 } })
                });
                const result = await response.json();
                if (result.predictions?.[0]) {
                    const url = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                    imageCache[category] = url;
                    img.src = url;
                }
            } catch (error) { img.src = "image_97e42e.png"; }
            finally { loader.style.display = 'none'; }
        }

        function filterParts(category) {
            document.querySelectorAll('.category-btn').forEach(btn => btn.className = "category-btn glass text-slate-400 px-6 py-3 rounded-xl font-black text-[10px] tracking-[0.2em] transition-all uppercase");
            const activeBtn = document.getElementById(`btn-${category}`);
            activeBtn.classList.add(category === 'all' ? 'btn-active-all' : anatomyData[category].btnClass);
            generateView(category);
            const panel = document.getElementById('info-panel');
            panel.innerHTML = '';
            const keys = category === 'all' ? Object.keys(anatomyData) : [category];
            keys.forEach(key => {
                const group = anatomyData[key];
                const div = document.createElement('div');
                div.className = "mb-10 opacity-0 translate-y-4 transition-all duration-700";
                let html = `<div class="flex items-center gap-2 mb-4"><span class="w-1.5 h-4 ${group.color.replace('text', 'bg')} rounded-full"></span><h2 class="text-[10px] font-black tracking-[0.4em] uppercase ${group.color}">${group.title}</h2></div><div class="grid gap-3">`;
                group.parts.forEach(p => {
                    html += `
                        <div onclick="openDetail('${key}', '${p.name}')" class="glass p-5 rounded-[1.5rem] border ${group.bg} hover:border-white/20 transition-all group cursor-pointer active:scale-95">
                            <div class="flex justify-between items-start">
                                <h3 class="text-lg font-bold mb-1 ${group.color}">${p.name}</h3>
                                <div class="w-6 h-6 rounded-lg bg-white/5 flex items-center justify-center group-hover:bg-white/10 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="text-slate-500"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                                </div>
                            </div>
                            <p class="text-slate-500 text-xs font-light">${p.desc}</p>
                        </div>
                    `;
                });
                html += `</div>`;
                div.innerHTML = html;
                panel.appendChild(div);
                setTimeout(() => { div.style.opacity = '1'; div.style.transform = 'translateY(0)'; }, 50);
            });
        }

        function openDetail(category, partName) {
            const part = anatomyData[category].parts.find(p => p.name === partName);
            const group = anatomyData[category];
            const modal = document.getElementById('detail-modal');
            const content = document.getElementById('modal-content');
            const body = document.getElementById('modal-body');

            body.innerHTML = `
                <div class="flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-white/10 pb-6">
                    <div>
                        <div class="flex items-center gap-3 mb-2">
                             <div class="px-3 py-1 rounded-full bg-white/5 text-[9px] font-black text-slate-500 uppercase tracking-widest border border-white/5 uppercase">Nivel: Avanzado</div>
                             <div class="w-2 h-2 rounded-full ${group.color.replace('text', 'bg')} animate-pulse"></div>
                        </div>
                        <h2 class="text-4xl md:text-5xl font-black ${group.color}">${part.name}</h2>
                        <p class="text-slate-400 font-semibold text-xs tracking-widest mt-1 uppercase">Sistema: ${group.scientificTitle}</p>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-10">
                    <div class="space-y-4">
                        <div class="flex items-center gap-2 text-pink-400">
                             <h4 class="text-sm font-black uppercase tracking-widest">Explicación Sencilla</h4>
                        </div>
                        <p class="text-white text-xl font-light leading-relaxed italic border-l-2 border-pink-500/30 pl-6">
                            "${part.edu}"
                        </p>
                        <div class="bg-blue-500/5 p-5 rounded-3xl border border-blue-500/10">
                            <h5 class="text-[10px] font-black text-blue-400 uppercase tracking-widest mb-2 uppercase">Ubicación Visual</h5>
                            <p class="text-slate-400 text-sm font-light">${part.visual}</p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="flex items-center gap-2 text-blue-400">
                             <h4 class="text-sm font-black uppercase tracking-widest">Explicación Científica</h4>
                        </div>
                        <p class="text-slate-300 text-sm leading-relaxed font-medium bg-white/5 p-6 rounded-[2rem]">
                            ${part.technical}
                        </p>
                        
                        <div class="pt-2">
                            <h5 class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-3 uppercase">Glosario Técnico:</h5>
                            <div class="flex flex-wrap gap-2">
                                ${part.vocabulary.map(v => `
                                    <div class="group relative">
                                        <div class="px-3 py-1 bg-white/5 rounded-lg text-xs font-bold border border-white/5 hover:bg-white/10 transition-colors cursor-help">
                                            ${v.term}
                                        </div>
                                        <div class="absolute bottom-full left-0 mb-2 w-48 p-3 glass rounded-xl text-[10px] opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity z-50">
                                            <span class="font-bold text-white block mb-1 underline decoration-pink-500 uppercase">${v.term}:</span>
                                            ${v.def}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            setTimeout(() => {
                content.classList.remove('scale-90', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closeDetail() {
            const modal = document.getElementById('detail-modal');
            const content = document.getElementById('modal-content');
            content.classList.add('scale-90', 'opacity-0');
            document.body.style.overflow = 'auto';
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().then(() => {
                    document.getElementById('fs-icon-enter').classList.add('hidden');
                    document.getElementById('fs-icon-exit').classList.remove('hidden');
                });
            } else {
                document.exitFullscreen();
                document.getElementById('fs-icon-enter').classList.remove('hidden');
                document.getElementById('fs-icon-exit').classList.add('hidden');
            }
        }

        window.onload = () => filterParts('all');
    </script>
</body>
</html>
